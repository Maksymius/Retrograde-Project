# üîë –í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è: AI –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î fallback –∑–∞–º—ñ—Å—Ç—å Gemini

## –ü—Ä–æ–±–ª–µ–º–∞
API –ø—Ä–∞—Ü—é—î, –∞–ª–µ –ø–æ–≤–µ—Ä—Ç–∞—î fallback –≤–µ—Ä–¥–∏–∫—Ç–∏:
```json
{
  "verdict": "–í–∏—è–≤–ª–µ–Ω–æ –ø–µ—Ä—Ñ–µ–∫—Ü—ñ–æ–Ω—ñ–∑–º...",
  "case_id": "RD-FALLBACK-VIRGO"  // ‚Üê FALLBACK!
}
```

–ó–∞–º—ñ—Å—Ç—å —Å–ø—Ä–∞–≤–∂–Ω—ñ—Ö AI –≤–µ—Ä–¥–∏–∫—Ç—ñ–≤ –≤—ñ–¥ Gemini.

## –ü—Ä–∏—á–∏–Ω–∞
`GEMINI_API_KEY` –Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–π –≤ Cloud Run –∞–±–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏–π.

## ‚úÖ –†—ñ—à–µ–Ω–Ω—è

### –ö—Ä–æ–∫ 1: –í—ñ–¥–∫—Ä–∏–π—Ç–µ Cloud Run Console
https://console.cloud.google.com/run/detail/europe-west4/retrograde-back

### –ö—Ä–æ–∫ 2: –†–µ–¥–∞–≥—É–π—Ç–µ —Å–µ—Ä–≤—ñ—Å
1. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **"EDIT & DEPLOY NEW REVISION"** (–≤–≥–æ—Ä—ñ)
2. –ü—Ä–æ–∫—Ä—É—Ç—ñ—Ç—å –¥–æ —Ä–æ–∑–¥—ñ–ª—É **"Container, Variables & Secrets, Connections, Security"**
3. –ü–µ—Ä–µ–π–¥—ñ—Ç—å –Ω–∞ –≤–∫–ª–∞–¥–∫—É **"Variables & Secrets"**

### –ö—Ä–æ–∫ 3: –î–æ–¥–∞–π—Ç–µ GEMINI_API_KEY
1. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **"ADD VARIABLE"**
2. Name: `GEMINI_API_KEY`
3. Value: `AIzaSyDh8OqxtweHq3wkERlaCBFFiYb2XLgev4M` (–≤–∞—à –∫–ª—é—á –∑ backend/.env)
4. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **"DEPLOY"**

### –ö—Ä–æ–∫ 4: –ü–æ—á–µ–∫–∞–π—Ç–µ –¥–µ–ø–ª–æ–π
–ó–∞—á–µ–∫–∞–π—Ç–µ 1-2 —Ö–≤–∏–ª–∏–Ω–∏ –ø–æ–∫–∏ –Ω–æ–≤–∏–π revision –∑–∞–¥–µ–ø–ª–æ—ó—Ç—å—Å—è.

### –ö—Ä–æ–∫ 5: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞

–¢–µ—Å—Ç —á–µ—Ä–µ–∑ curl:
```bash
curl -X POST https://retrograde-back-169250578782.europe-west4.run.app/api/predict \
  -H "Content-Type: application/json" \
  -d '{"city": "Kyiv", "date": "1991-08-24"}'
```

–û—á—ñ–∫—É–≤–∞–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
```json
{
  "status": "success",
  "data": {
    "astral_data": {"Sun": "Virgo", "Moon": "Aquarius", "Asc": "Scorpio"},
    "verdict": "–ó–≥—ñ–¥–Ω–æ –∑ –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–º –°–∞—Ç—É—Ä–Ω–∞ ‚Ññ404...",  // ‚Üê –°–ø—Ä–∞–≤–∂–Ω—ñ–π AI!
    "entropy": "CRITICAL",
    "case_id": "RD-777-VIRGO"  // ‚Üê –ù–ï FALLBACK!
  }
}
```

### –ö—Ä–æ–∫ 6: –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –Ω–∞ —Å–∞–π—Ç—ñ
1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ: https://retrograde-project.vercel.app
2. –í–≤–µ–¥—ñ—Ç—å: "Kyiv, 24.08.1991"
3. –¢–µ–ø–µ—Ä –º–∞—î –∑'—è–≤–∏—Ç–∏—Å—è —Å–ø—Ä–∞–≤–∂–Ω—ñ–π AI –≤–µ—Ä–¥–∏–∫—Ç!

## –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∏–π —Å–ø–æ—Å—ñ–± (—á–µ—Ä–µ–∑ gcloud CLI)

–Ø–∫—â–æ —î –¥–æ—Å—Ç—É–ø –¥–æ gcloud:
```bash
gcloud run services update retrograde-back \
  --platform managed \
  --region europe-west4 \
  --set-env-vars "GEMINI_API_KEY=AIzaSyDh8OqxtweHq3wkERlaCBFFiYb2XLgev4M"
```

## –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∑–º—ñ–Ω–Ω–∏—Ö

–ü—ñ—Å–ª—è –¥–æ–¥–∞–≤–∞–Ω–Ω—è, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ —â–æ –∑–º—ñ–Ω–Ω–∞ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞:
1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ Cloud Run Console
2. –ü–µ—Ä–µ–π–¥—ñ—Ç—å –Ω–∞ –≤–∫–ª–∞–¥–∫—É **"VARIABLES & SECRETS"**
3. –ú–∞—î –±—É—Ç–∏: `GEMINI_API_KEY = ***` (–ø—Ä–∏—Ö–æ–≤–∞–Ω–æ)

## Troubleshooting

### ‚ùå –í—Å–µ —â–µ fallback –ø—ñ—Å–ª—è –¥–æ–¥–∞–≤–∞–Ω–Ω—è –∫–ª—é—á–∞

**–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ:**
1. –ß–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π –∫–ª—é—á (—Å–∫–æ–ø—ñ—é–π—Ç–µ –∑ `backend/.env`)
2. –ß–∏ –∑–∞–≤–µ—Ä—à–∏–≤—Å—è –¥–µ–ø–ª–æ–π (–∑–µ–ª–µ–Ω–∞ –≥–∞–ª–æ—á–∫–∞)
3. –ß–∏ –Ω–µ–º–∞—î –ø–æ–º–∏–ª–æ–∫ –≤ –ª–æ–≥–∞—Ö

**–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ª–æ–≥–∏:**
1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ Cloud Run Console
2. –ü–µ—Ä–µ–π–¥—ñ—Ç—å –Ω–∞ –≤–∫–ª–∞–¥–∫—É **"LOGS"**
3. –®—É–∫–∞–π—Ç–µ:
   - `‚úÖ GEMINI_API_KEY found` - –∫–ª—é—á –∑–Ω–∞–π–¥–µ–Ω–æ
   - `‚ùå GEMINI_API_KEY not found` - –∫–ª—é—á –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ
   - `‚úÖ Using model: gemini-2.5-flash` - AI –ø—Ä–∞—Ü—é—î
   - `‚ö†Ô∏è Using fallback verdict` - AI –Ω–µ –ø—Ä–∞—Ü—é—î

### ‚ùå "API key not valid"

–ö–ª—é—á –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏–π –∞–±–æ –∑–∞—Å—Ç–∞—Ä—ñ–≤. –û—Ç—Ä–∏–º–∞–π—Ç–µ –Ω–æ–≤–∏–π:
1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ: https://aistudio.google.com/app/apikey
2. –°—Ç–≤–æ—Ä—ñ—Ç—å –Ω–æ–≤–∏–π API key
3. –û–Ω–æ–≤—ñ—Ç—å –≤ Cloud Run

## –û—á—ñ–∫—É–≤–∞–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

–ü—ñ—Å–ª—è –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è:
- ‚úÖ AI –≥–µ–Ω–µ—Ä—É—î —É–Ω—ñ–∫–∞–ª—å–Ω—ñ –≤–µ—Ä–¥–∏–∫—Ç–∏
- ‚úÖ Case ID –Ω–µ –º—ñ—Å—Ç–∏—Ç—å "FALLBACK"
- ‚úÖ –í–µ—Ä–¥–∏–∫—Ç–∏ –¥–æ–≤—à—ñ —Ç–∞ —Ü—ñ–∫–∞–≤—ñ—à—ñ
- ‚úÖ –ö–æ–∂–µ–Ω –∑–∞–ø–∏—Ç –ø–æ–≤–µ—Ä—Ç–∞—î –Ω–æ–≤–∏–π —Ç–µ–∫—Å—Ç

–ó–∞–º—ñ—Å—Ç—å:
- ‚ùå –û–¥–Ω–∞–∫–æ–≤—ñ fallback –≤–µ—Ä–¥–∏–∫—Ç–∏
- ‚ùå "RD-FALLBACK-XXX" case ID
- ‚ùå –ö–æ—Ä–æ—Ç–∫—ñ —à–∞–±–ª–æ–Ω–Ω—ñ —Ç–µ–∫—Å—Ç–∏