–•–∞-—Ö–∞, "Google DNA" ‚Äî —Ü–µ –Ω–∞–π–∫—Ä–∞—â–∏–π –∫–æ–º–ø–ª—ñ–º–µ–Ω—Ç! –Ø–∫—â–æ —î —Ç—Ä–∞—Ñ—ñ–∫, –π–æ–≥–æ —Ç—Ä–µ–±–∞ –º–æ–Ω–µ—Ç–∏–∑—É–≤–∞—Ç–∏ –∞–±–æ –º–∞—Å—à—Ç–∞–±—É–≤–∞—Ç–∏. –¢—Ä–µ—Ç—å–æ–≥–æ –Ω–µ –¥–∞–Ω–æ.

–û—Å–∫—ñ–ª—å–∫–∏ –º–∏ –π–¥–µ–º–æ —à–ª—è—Ö–æ–º **KISS (Keep It Simple, Stupid)** —ñ —É –Ω–∞—Å –¥–æ—Å—ñ –Ω–µ–º–∞—î –ë–∞–∑–∏ –î–∞–Ω–∏—Ö (—ñ —Å–ª–∞–≤–∞ –±–æ–≥—É), –º–∏ —Ä–µ–∞–ª—ñ–∑—É—î–º–æ –º–µ—Ö–∞–Ω—ñ–∫—É **"Stateless Invitation"**.

**–°—É—Ç—å —Ö–∞–∫—É:**
–ú–∏ –Ω–µ –±—É–¥–µ–º–æ –∑–±–µ—Ä—ñ–≥–∞—Ç–∏ –¥–∞–Ω—ñ "–ñ–µ—Ä—Ç–≤–∏ ‚Ññ1" –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ. –ú–∏ "–∑–∞—à–∏—î–º–æ" –¥–∞—Ç—É –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è –ø–µ—Ä—à–æ–≥–æ —é–∑–µ—Ä–∞ –ø—Ä—è–º–æ –≤ –ø–æ—Å–∏–ª–∞–Ω–Ω—è, —è–∫–µ –≤—ñ–Ω –∫–∏–Ω–µ –¥—Ä—É–≥–æ–º—É.
–¶–µ —è–∫ –ø–µ—Ä–µ–¥–∞—Ç–∏ –¥–∏—Å–∫–µ—Ç—É –∑ –≤—ñ—Ä—É—Å–æ–º.

–û—Å—å –ø–æ–∫—Ä–æ–∫–æ–≤–∏–π –ø–ª–∞–Ω –∑–∞—Ö–æ–ø–ª–µ–Ω–Ω—è —Å–≤—ñ—Ç—É (—Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó —Ñ—ñ—á—ñ **"Synastry of Doom"**).

---

### –ï—Ç–∞–ø 1. Backend: –ê–ø–≥—Ä–µ–π–¥ –ú–æ–∑–∫—É (API)

–ù–∞–º –ø–æ—Ç—Ä—ñ–±–µ–Ω –Ω–æ–≤–∏–π –µ–Ω–¥–ø–æ—ñ–Ω—Ç, —è–∫–∏–π –ø—Ä–∏–π–º–∞—î **–î–í–Ü** –¥–∞—Ç–∏ –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è —ñ –∫–∞–∂–µ, —á–æ–º—É —ó–º –Ω–µ –º–æ–∂–Ω–∞ –±—É—Ç–∏ —Ä–∞–∑–æ–º.

**1. –û–Ω–æ–≤–∏ `backend/app/astrology.py`** (–∞–±–æ —Å—Ç–≤–æ—Ä–∏ —Ñ—É–Ω–∫—Ü—ñ—é –≤ `main.py`, —è–∫—â–æ —Ç–∞–º):
–î–æ–¥–∞–π –ª–æ–≥—ñ–∫—É –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è. –ü–æ–∫–∏ —â–æ –ø—Ä–æ—Å—Ç–æ –∑–±–µ—Ä–µ–º–æ –¥–∞–Ω—ñ –¥–≤–æ—Ö –ª—é–¥–µ–π.

**2. –û–Ω–æ–≤–∏ `backend/app/ai_engine.py`**:
–î–æ–¥–∞–π –Ω–æ–≤—É —Ñ—É–Ω–∫—Ü—ñ—é `generate_synastry_verdict`.

```python
# backend/app/ai_engine.py

def generate_synastry_verdict(user1_planets, user2_planets):
    # –ü—Ä–æ–º–ø—Ç –¥–ª—è —Ç–æ–∫—Å–∏—á–Ω–æ—ó —Å—É–º—ñ—Å–Ω–æ—Å—Ç—ñ
    sys_prompt = """
    –¢–∏ ‚Äî –®–Ü-–∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç –∑ —Ä–æ–∑–ª—É—á–µ–Ω—å –î–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç—É –†–µ—Ç—Ä–æ–≥—Ä–∞–¥–Ω–æ—Å—Ç—ñ.
    –¢–≤–æ—è –∑–∞–¥–∞—á–∞: –ø—Ä–æ–∞–Ω–∞–ª—ñ–∑—É–≤–∞—Ç–∏ —Å—É–º—ñ—Å–Ω—ñ—Å—Ç—å –¥–≤–æ—Ö –æ–±'—î–∫—Ç—ñ–≤ —ñ –ø–æ—è—Å–Ω–∏—Ç–∏, —á–æ–º—É —ó—Ö–Ω—ñ–π —Å–æ—é–∑ ‚Äî —Ü–µ –∫–∞—Ç–∞—Å—Ç—Ä–æ—Ñ–∞.
    –°—Ç–∏–ª—å: —Å–∞—Ä–∫–∞—Å—Ç–∏—á–Ω–∏–π, –∂–æ—Ä—Å—Ç–∫–∏–π, —Ñ–∞—Ç–∞–ª—ñ—Å—Ç–∏—á–Ω–∏–π.
    –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π —Ç–µ—Ä–º—ñ–Ω–∏: "–∫–æ–Ω—Ñ–ª—ñ–∫—Ç –ú–∞—Ä—Å—ñ–≤", "–Ω–µ—Å—É–º—ñ—Å–Ω—ñ—Å—Ç—å –µ–≥–æ", "–∫–∞—Ä–º—ñ—á–Ω–∏–π —Ç—É–ø–∏–∫".
    """
    
    user_prompt = f"""
    –û–±'—î–∫—Ç –ê: {user1_planets}
    –û–±'—î–∫—Ç –ë: {user2_planets}
    
    –ó—Ä–æ–±–∏ –ø—Ä–æ–≥–Ω–æ–∑:
    1. –†—ñ–≤–µ–Ω—å —Ç–æ–∫—Å–∏—á–Ω–æ—Å—Ç—ñ (0-100%).
    2. –ì–æ–ª–æ–≤–Ω–∞ –ø—Ä–∏—á–∏–Ω–∞ –º–∞–π–±—É—Ç–Ω—å–æ–≥–æ —Ä–æ–∑—Ä–∏–≤—É.
    3. –í–µ—Ä–¥–∏–∫—Ç (2-3 —Ä–µ—á–µ–Ω–Ω—è).
    """
    
    # ... —Ç—É—Ç –≤–∏–∫–ª–∏–∫ Gemini (—è–∫ –≤ generate_verdict) ...
    # –ü–æ–≤–µ—Ä–Ω–∏ JSON –∞–±–æ —Ç–µ–∫—Å—Ç
```

**3. –ù–æ–≤–∏–π –µ–Ω–¥–ø–æ—ñ–Ω—Ç —É `main.py`**:

```python
class SynastryRequest(BaseModel):
    date1: str
    location1: str
    date2: str
    location2: str

@app.post("/api/synastry")
async def calculate_synastry(req: SynastryRequest):
    # 1. –†–∞—Ö—É—î–º–æ –ø–ª–∞–Ω–µ—Ç–∏ –¥–ª—è –æ–±–æ—Ö
    p1 = get_astro_data(req.location1, datetime.fromisoformat(req.date1))
    p2 = get_astro_data(req.location2, datetime.fromisoformat(req.date2))
    
    # 2. –ü–∏—Ç–∞—î–º–æ AI
    verdict = await generate_synastry_verdict(p1, p2)
    
    return {"status": "success", "data": verdict}
```

---

### –ï—Ç–∞–ø 2. Frontend: –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ü–∞—Å—Ç–∫–∏ (Creator Mode)

–°—Ç–≤–æ—Ä—é—î–º–æ —Å—Ç–æ—Ä—ñ–Ω–∫—É `/app/compatibility/page.tsx`.

–¢—É—Ç –Æ–∑–µ—Ä ‚Ññ1 –≤–≤–æ–¥–∏—Ç—å —Å–≤–æ—ó –¥–∞–Ω—ñ. –ê–ª–µ –∑–∞–º—ñ—Å—Ç—å "–û—Ç—Ä–∏–º–∞—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç", –≤—ñ–Ω –±–∞—á–∏—Ç—å –∫–Ω–æ–ø–∫—É **[–°–¢–í–û–†–ò–¢–ò –ü–ê–°–¢–ö–£ / GENERATE LINK]**.

**–õ–æ–≥—ñ–∫–∞ –∫–æ–¥—É–≤–∞–Ω–Ω—è –ø–æ—Å–∏–ª–∞–Ω–Ω—è (The Magic):**
–ú–∏ –±–µ—Ä–µ–º–æ –¥–∞–Ω—ñ —é–∑–µ—Ä–∞ —ñ –∫–æ–¥—É—î–º–æ —ó—Ö —É Base64, —â–æ–± –ø–æ—Å–∏–ª–∞–Ω–Ω—è –≤–∏–≥–ª—è–¥–∞–ª–æ —Å—Ç—Ä–∞—à–Ω–æ —ñ —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ—á–Ω–æ.

```typescript
// –§—É–Ω–∫—Ü—ñ—è –∫–æ–¥—É–≤–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö —É —Ä—è–¥–æ–∫ –¥–ª—è URL
const generateInviteLink = (date: string, location: string) => {
  const data = JSON.stringify({ d: date, l: location })
  const encoded = btoa(data) // Base64 –∫–æ–¥—É–≤–∞–Ω–Ω—è
  // –ì–µ–Ω–µ—Ä—É—î–º–æ –ª—ñ–Ω–∫ –Ω–∞ –±–æ—Ç–∞ –∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º startapp
  return `https://t.me/RetrogradeDeptBot?startapp=${encoded}`
}
```

–ö–æ–ª–∏ —é–∑–µ—Ä —Ç–∏—Å–Ω–µ –∫–Ω–æ–ø–∫—É, –º–∏ –ø–æ–∫–∞–∑—É—î–º–æ –π–æ–º—É —Ü–µ–π –ª—ñ–Ω–∫ —ñ –∫–Ω–æ–ø–∫—É "–ö–æ–ø—ñ—é–≤–∞—Ç–∏".

---

### –ï—Ç–∞–ø 3. Frontend: –†–µ–∂–∏–º –ñ–µ—Ä—Ç–≤–∏ (Victim Mode)

–¶–µ –Ω–∞–π—Ü—ñ–∫–∞–≤—ñ—à–µ. –ö–æ–ª–∏ –Æ–∑–µ—Ä ‚Ññ2 –≤—ñ–¥–∫—Ä–∏–≤–∞—î —Ü–µ –ø–æ—Å–∏–ª–∞–Ω–Ω—è, –¢–µ–ª–µ–≥—Ä–∞–º –ø–µ—Ä–µ–¥–∞—î –ø–∞—Ä–∞–º–µ—Ç—Ä `startapp` —É –Ω–∞—à Mini App.

–ù–∞–º —Ç—Ä–µ–±–∞ –∑–ª–æ–≤–∏—Ç–∏ —Ü–µ–π –ø–∞—Ä–∞–º–µ—Ç—Ä –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—ñ.

**–£ `app/page.tsx` (–∞–±–æ –Ω–æ–≤–æ–º—É `layout`):**

```typescript
'use client'
import { useSearchParams } from 'next/navigation'
import { useEffect, useState } from 'react'

// ... –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ ...
const searchParams = useSearchParams()
const startParam = searchParams.get('tgWebAppStartParam') // –ê–±–æ –ø—Ä–æ—Å—Ç–æ —á–∏—Ç–∞—î–º–æ –∑ window.location

useEffect(() => {
  if (startParam) {
    try {
      // –î–µ–∫–æ–¥—É—î–º–æ –¥–∞–Ω—ñ –Æ–∑–µ—Ä–∞ ‚Ññ1
      const decoded = atob(startParam)
      const partnerData = JSON.parse(decoded)
      
      console.log("–ñ–µ—Ä—Ç–≤–∞ –ø–æ—Ç—Ä–∞–ø–∏–ª–∞ –≤ –ø–∞—Å—Ç–∫—É! –î–∞–Ω—ñ –ø–∞—Ä—Ç–Ω–µ—Ä–∞:", partnerData)
      // –ü–µ—Ä–µ–º–∏–∫–∞—î–º–æ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å —É —Ä–µ–∂–∏–º "–ü–û–†–Ü–í–ù–Ø–ù–ù–Ø"
      setMode('SYNASTRY')
      setPartnerData(partnerData)
    } catch (e) {
      console.error("Link corrupted")
    }
  }
}, [startParam])
```

**–©–æ –±–∞—á–∏—Ç—å –Æ–∑–µ—Ä ‚Ññ2:**
1.  –Ü–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∑–º—ñ–Ω—é—î—Ç—å—Å—è –Ω–∞ —á–µ—Ä–≤–æ–Ω–∏–π –∫–æ–ª—ñ—Ä (Alert Mode).
2.  –ù–∞–ø–∏—Å: *"–í–∏—è–≤–ª–µ–Ω–æ –≤—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ –æ–±'—î–∫—Ç–∞ –•. –í–≤–µ–¥—ñ—Ç—å —Å–≤–æ—ó –¥–∞–Ω—ñ –¥–ª—è —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É –π–º–æ–≤—ñ—Ä–Ω–æ—Å—Ç—ñ –≤–∏–∂–∏–≤–∞–Ω–Ω—è."*
3.  –í–≤–æ–¥–∏—Ç—å —Å–≤–æ—ó –¥–∞–Ω—ñ -> –¢–∏—Å–Ω–µ –∫–Ω–æ–ø–∫—É -> –û—Ç—Ä–∏–º—É—î –ø–æ–¥–≤—ñ–π–Ω–∏–π —Ä–æ–∑—Ä–∞—Ö—É–Ω–æ–∫.

---

### –ï—Ç–∞–ø 4. –í—ñ–∑—É–∞–ª: "–ó—ñ—Ç–∫–Ω–µ–Ω–Ω—è –°–≤—ñ—Ç—ñ–≤"

–î–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É —Å—É–º—ñ—Å–Ω–æ—Å—Ç—ñ (`ResultCard`) –Ω–∞–º —Ç—Ä–µ–±–∞ —â–æ—Å—å –µ–ø—ñ—á–Ω–µ.
–ó–∞–º—ñ—Å—Ç—å –æ–¥–Ω–æ–≥–æ —Ä–∞–¥–∞—Ä–∞ ‚Äî **–¥–≤–∞ —Ä–∞–¥–∞—Ä–∏**, —è–∫—ñ –Ω–∞–∫–ª–∞–¥–∞—é—Ç—å—Å—è –æ–¥–∏–Ω –Ω–∞ –æ–¥–Ω–æ–≥–æ, –∞–±–æ –¥–≤—ñ "—Ä—ñ–¥–∫—ñ —Å—Ñ–µ—Ä–∏" (—á–µ—Ä–≤–æ–Ω–∞ —ñ —Å–∏–Ω—è), —è–∫—ñ –Ω–∞–º–∞–≥–∞—é—Ç—å—Å—è –∑–ª–∏—Ç–∏—Å—è, –∞–ª–µ —ó—Ö "–∫–æ–≤–±–∞—Å–∏—Ç—å".

---

### –¢–≤—ñ–π Task List –¥–ª—è –∫–æ–¥–µ—Ä–∞:

1.  **Backend:**
    *   [ ] –î–æ–¥–∞—Ç–∏ –º–µ—Ç–æ–¥ `generate_synastry_verdict` –≤ AI Engine (–∑–ª–∏–π –ø—Ä–æ–º–ø—Ç).
    *   [ ] –î–æ–¥–∞—Ç–∏ –µ–Ω–¥–ø–æ—ñ–Ω—Ç `POST /api/synastry`.

2.  **Frontend:**
    *   [ ] –°—Ç–≤–æ—Ä–∏—Ç–∏ –ª–æ–≥—ñ–∫—É –∫–æ–¥—É–≤–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö —É Base64 (`btoa`).
    *   [ ] –†–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ —á–∏—Ç–∞–Ω–Ω—è –ø–∞—Ä–∞–º–µ—Ç—Ä—É –∑–∞–ø—É—Å–∫—É (`start_param`) –ø—Ä–∏ –≤—Ö–æ–¥—ñ.
    *   [ ] –Ø–∫—â–æ –ø–∞—Ä–∞–º–µ—Ç—Ä —î ‚Äî –ø–æ–∫–∞–∑–∞—Ç–∏ –µ–∫—Ä–∞–Ω "VS" (Versus), –¥–µ —é–∑–µ—Ä –≤–≤–æ–¥–∏—Ç—å —Ç—ñ–ª—å–∫–∏ *—Å–≤–æ—ó* –¥–∞–Ω—ñ (–¥–∞–Ω—ñ –ø–∞—Ä—Ç–Ω–µ—Ä–∞ –≤–∂–µ —î –∑ –ª—ñ–Ω–∫–∞).
    *   [ ] –í—ñ–¥–æ–±—Ä–∞–∑–∏—Ç–∏ –≤–µ—Ä–¥–∏–∫—Ç —Å—É–º—ñ—Å–Ω–æ—Å—Ç—ñ.

–¶–µ **–≥–µ–Ω—ñ–∞–ª—å–Ω–∞ –º–µ—Ö–∞–Ω—ñ–∫–∞**, –±–æ –≤–æ–Ω–∞ –Ω–µ –ø–æ—Ç—Ä–µ–±—É—î —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó, –ë–î —á–∏ —Å–∫–ª–∞–¥–Ω–∏—Ö —Å–µ—Ä–≤–µ—Ä—ñ–≤. –í—Å–µ –ø–µ—Ä–µ–¥–∞—î—Ç—å—Å—è —á–µ—Ä–µ–∑ URL. –ß–∏—Å—Ç–∏–π –≤—ñ—Ä–∞–ª—å–Ω–∏–π –Ω–∞—Ä–∫–æ—Ç–∏–∫. üíâ